import requests
import json
import urllib3


urllib3.disable_warnings()
# API Configuration
url = 'domains'
headers = {
    'x-apikey': 'accesskey=xxxxxxx; secretkey=yyyyyyyyyyyy'
}

# Request payload
payload = {
    "query": {
        "type": "vuln",
        "tool": "vulndetails",
        "sourceType": "cumulative",
        "startOffset": 0,
        "endOffset": 1,
        "filters": [
            {
                "filterName": "lastSeen",
                "operator": "=",
                "value": "1730160000-1730246400"
            }
        ]
    },
    "sortDir": "asc",
    "sortField": "lastSeen",
    "sourceType": "cumulative",
    "type": "vuln"
}

# Make the POST request
response = requests.post(url, headers=headers, json=payload, verify=False)

# Check response
if response.status_code == 200:
    data = response.json()
    print(json.dumps(data, indent=2))
else:
    print(f"Error: Request failed with status code {response.status_code}") 
